<!--A Design by W3layouts
Author: W3layout
Author URL: http://w3layouts.com
License: Creative Commons Attribution 3.0 Unported
License URL: http://creativecommons.org/licenses/by/3.0/
-->
<!DOCTYPE html>
<html>
<head>
    <title>@ViewBag.Title</title>
    <link href="~/Content/css/bootstrap-3.1.1.min.css" rel='stylesheet' type='text/css' />
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="~/Content/js/jquery.min.js"></script>
    <!-- Custom Theme files -->
    <!--theme-style-->
    <link href="~/Content/css/style.css" rel="stylesheet" type="text/css" media="all" />
    <!--//theme-style-->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="@ViewBag.Title" />
    <script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>
    <link href='//fonts.googleapis.com/css?family=Raleway' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Poiret+One' rel='stylesheet' type='text/css'>
    <!-- start menu -->
    <script src="~/Content/js/bootstrap.min.js"></script>
    <!-- slide -->
    <!-- animation-effect -->
    <link href="~/Content/css/animate.min.css" rel="stylesheet">
    <script src="~/Content/js/wow.min.js"></script>
    <script>
        new WOW().init();
    </script>
    <style>
        .header-top{
            padding: 0px
        }
        .header-top .container {
            display: flex;
            align-items: center; /* Căn giữa theo chiều dọc */
            justify-content: space-between; /* Các phần tử dàn đều */
            flex-wrap: wrap; /* Cho phép xuống dòng nếu không đủ không gian */
        }

        .logo img {
            max-width: 100px;
        }

        .search {
            flex-grow: 1; /* Cho phép ô tìm kiếm co giãn */
            max-width: 300px;
        }

        .world {
            display: flex;
            align-items: center;
        }

        .number {
            margin-left: 15px; /* Khoảng cách giữa giỏ hàng và user */
        }

        .footer {
            background-color: #222;
            color: #fff;
            padding: 40px 0;
            font-size: 14px;
        }

        /* Sử dụng Flexbox để tạo 3 cột ngang */
        .footer-container {
            display: flex;
            justify-content: space-between; /* Chia đều khoảng cách */
            align-items: flex-start;
            max-width: 1200px;
            margin: auto;
            flex-wrap: wrap;
        }

        /* Cấu trúc từng cột */
        .footer-column {
            width: 30%; /* Mỗi cột chiếm 30% */
            min-width: 250px;
            padding: 0 15px;
        }

            .footer-column h4 {
                font-size: 18px;
                margin-bottom: 15px;
                border-bottom: 2px solid #f1c40f;
                padding-bottom: 5px;
            }

            .footer-column p, .footer-links {
                color: #ccc;
            }

        .footer-links {
            list-style: none;
            padding: 0;
        }

            .footer-links li {
                margin-bottom: 8px;
            }

            .footer-links a {
                color: #ddd;
                text-decoration: none;
                transition: 0.3s;
            }

                .footer-links a:hover {
                    color: #f1c40f;
                }

        /* Style mạng xã hội */
        .social-icons {
            margin-top: 10px;
        }

            .social-icons a {
                display: inline-block;
                margin-right: 10px;
                font-size: 20px;
                color: #fff;
                transition: 0.3s;
            }

                .social-icons a:hover {
                    color: #f1c40f;
                }

        /* Dòng bản quyền */
        .footer-bottom {
            text-align: center;
            padding: 15px 0;
            background-color: #111;
   
        }

            .footer-bottom a {
                color: #f1c40f;
                text-decoration: none;
            }
    </style>
    <!-- //animation-effect -->
</head>
<body>
    <!--header-->
    <div class="header">
        <div class="header-top">
            <div class="container d-flex justify-content-between align-items-center">
                <!-- Logo -->
                <div class="logo animated wow fadeInLeft" data-wow-delay=".5s">
                    <img style="width:100px" src="~/Content/images/logo.jpg" />
                </div>

                <!-- Ô tìm kiếm -->
                <div class="search animated wow fadeInRight" data-wow-delay=".5s">
                    <form action="/Product/Index" method="get" class="search-form">
                        <div class="input-group">
                            <input type="text" name="keyword" class="form-control" placeholder="Nhập từ khóa..." required>
                            <span class="input-group-btn">
                                <button class="btn btn-primary" type="submit">
                                    <i style="color:white" class="glyphicon glyphicon-search"></i>
                                </button>
                            </span>
                        </div>
                    </form>
                </div>


                <!-- Giỏ hàng -->
                <div class="world animated wow fadeInRight" data-wow-delay=".5s">
                    <div class="cart box_1">
                        <a href="/Cart/Checkout">

                            <img style="height:30px" src="~/Content/images/cart.png" alt="" />
                        </a>
                    </div>
                    <a href="/Cart/Checkout" style="color:black">&nbsp Giỏ hàng &nbsp</a>
                </div>

                <!-- Thông tin user -->
                @{
                    CosmeticsShop.Models.User user = Session["User"] as CosmeticsShop.Models.User;
                    if (user != null)
                    {
                        <input type="text" id="UserID" value="@user.ID" hidden />
                        <div class="number animated wow fadeInRight" data-wow-delay=".5s">
                            <span><i class="glyphicon glyphicon-user"></i> <a href="/User/CheckoutOrder">@user.Name</a></span>
                        </div>
                    }
                }

            </div>
        </div>

        <div class="container">
            <div class="head-top">
                <div class="n-avigation">

                    <nav class="navbar nav_bottom" role="navigation">

                        <!-- Brand and toggle get grouped for better mobile display -->
                        <div class="navbar-header nav_2">
                            <button type="button" class="navbar-toggle collapsed navbar-toggle1" data-toggle="collapse" data-target="#bs-megadropdown-tabs">
                                <span class="sr-only">Toggle navigation</span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                            </button>
                            <a class="navbar-brand" href="#"></a>
                        </div>
                        <!-- Collect the nav links, forms, and other content for toggling -->
                        <div class="collapse navbar-collapse" id="bs-megadropdown-tabs">
                            <ul class="nav navbar-nav nav_1">
                                <li><a href="/">Trang chủ</a></li>
                                <li><a href="/Product/">Sản phẩm</a></li>
                                <li><a href="/Product/">Giới thiệu</a></li>
                                <li><a href="/Product/">Liên hệ</a></li>
                                @if (user != null)
                                {
                                    <li><a href="/Home/SignOut">Đăng xuất</a></li>
                                }
                                else
                                {
                                    <li><a href="/Home/SignIn">Đăng nhập/Đăng kí</a></li>
                                }
                            </ul>
                        </div><!-- /.navbar-collapse -->

                    </nav>
                </div>


                <div class="clearfix"> </div>
                <!---pop-up-box---->
                <link href="~/Content/css/popuo-box.css" rel="stylesheet" type="text/css" media="all" />
                <script src="~/Content/js/jquery.magnific-popup.js" type="text/javascript"></script>
                <!---//pop-up-box---->
                <div id="small-dialog" class="mfp-hide">
                    <div class="search-top">
                        <div class="login">
                            <form action="/Product/Index" method="get">
                                <input type="submit" value="">
                                <input type="text" name="keyword" value="Nhập vào từ khóa..." onfocus="this.value = '';" onblur="if (this.value == '') {this.value = '';}">
                            </form>
                        </div>
                    </div>
                </div>
                <script>
                    $(document).ready(function () {
                        $('.popup-with-zoom-anim').magnificPopup({
                            type: 'inline',
                            fixedContentPos: false,
                            fixedBgPos: true,
                            overflowY: 'auto',
                            closeBtnInside: true,
                            preloader: false,
                            midClick: true,
                            removalDelay: 300,
                            mainClass: 'my-mfp-zoom-in'
                        });

                    });
                </script>
            </div>
        </div>
    </div>

    @RenderBody()


    <div class="row">
        <div class="chatbox chatbox22 chatbox--tray">
            <div class="chatbox__title">
                <h5><a href="javascript:void()">Chat với chúng tôi</a></h5>
                <button class="chatbox__title__tray">
                    <span></span>
                </button>
                <button class="chatbox__title__close">
                    <span>
                        <svg viewBox="0 0 12 12" width="12px" height="12px">
                            <line stroke="#FFFFFF" x1="11.75" y1="0.25" x2="0.25" y2="11.75"></line>
                            <line stroke="#FFFFFF" x1="11.75" y1="11.75" x2="0.25" y2="0.25"></line>
                        </svg>
                    </span>
                </button>
            </div>
            @if (Session["User"] == null)
            {
                <div class="chatbox__body">
                    <h5>Vui lòng đăng nhập để chat</h5>
                </div>
            }
            else
            {
                <div class="chatbox__body">

                </div>
                <div class="panel-footer">
                    <div class="input-group">
                        <input id="btn-input" type="text" required class="form-control input-sm chat_set_height" placeholder="Soạn tin nhắn..." tabindex="0" dir="ltr" spellcheck="false" autocomplete="off" autocorrect="off" autocapitalize="off" contenteditable="true" />
                        <span class="input-group-btn">
                            <button class="btn bt_bg btn-sm" id="btn-chat">
                                Gửi
                            </button>
                            <img src="~/Content/images/loading.gif" class="loading-send btn bt_bg btn-sm" style="display:none;" />
                        </span>
                    </div>
                </div>
            }
        </div>
    </div>

    <!-- Footer -->
    <div class="footer">
        <div class="footer-container">
            <!-- Cột 1: Giới thiệu -->
            <div class="footer-column">
                <h4>NỘI THẤT HOMAROOM</h4>
                <p>Nội Thất HOMAROOM là thương hiệu đến từ Savimex với gần 40 năm kinh nghiệm trong việc sản xuất và xuất khẩu nội thất đạt chuẩn quốc tế.</p>
            </div>

            <!-- Cột 2: Dịch vụ -->
            <div class="footer-column">
                <h4>DỊCH VỤ</h4>
                <ul class="footer-links">
                    <li><a href="#">Chính Sách Bán Hàng</a></li>
                    <li><a href="#">Chính Sách Giao Hàng & Lắp Đặt</a></li>
                    <li><a href="#">Chính Sách Bảo Hành & Bảo Trì</a></li>
                    <li><a href="#">Chính Sách Đổi Trả</a></li>
                    <li><a href="#">Chính Sách Đối Tác Bán Hàng</a></li>
                    <li><a href="#">Khách Hàng Thân Thiết – MOHOmie</a></li>
                </ul>
            </div>

            <!-- Cột 3: Liên hệ -->
            <div class="footer-column">
                <h4>THÔNG TIN LIÊN HỆ</h4>
                <p><strong>Phone:</strong> +84 234 432 555</p>
                <p><strong>Email:</strong> noithat@gmail.com</p>
                <p><strong>Địa chỉ:</strong> Hà Nội</p>
                <div class="social-icons">
                    <a href="#"><i class="fa fa-facebook"></i></a>
                    <a href="#"><i class="fa fa-youtube"></i></a>
                    <a href="#"><i class="fa fa-google"></i></a>
                </div>
            </div>
        </div>
    </div>

    <!-- Bản quyền -->
    <div class="footer-bottom">
        <p style="color:white">Copyright © 2025 <a href="~/Views/Home/Index.cshtml">Nội Thất HOMAROOM</a>.</p>
    </div>


    <script type="text/javascript">
        $(document).ready(function () {
            $(function () {
                var chat = $.connection.chatHubs
                chat.client.displayMessage = function () {
                    getAllData();
                }
                $.connection.hub.start();
                getAllData();
            })
            var lastMessID = 0;
            function getAllData() {
                var chatbox = $('.chatbox__body');
                var userID = $('#UserID').val();
                $.ajax({
                    url: location.origin + "/Chat/GetAllMessageChating?UserID=" + userID,
                    type: 'GET',
                    dataType: 'JSON',
                    success: function (data) {
                        chatbox.empty()
                        if (data.length > 0) {
                            $.each(data, function (i, model) {
                                var date = new Date(parseInt(model.CreatedDate.substr(6)));
                                if (model.FromUserID == userID) {
                                    lastMessID = model.ID;
                                    chatbox.append(
                                        '<div class="chatbox__body__message chatbox__body__message--right" id="' + model.ID + '"' + '>' +
                                        ' <div class="chatbox_timing">' +
                                        '<ul>' +
                                        '<li>' + date.getHours() + ':' + date.getMinutes() + '</li>' +
                                        '</ul>' +
                                        '</div>' +
                                        '<img src="/Content/images/' + model.FromAvatarUser + '" alt="Picture">' +
                                        '<div class="clearfix"></div>' +
                                        ' <div class="ul_section_full">' +
                                        ' <ul class="ul_msg">' +
                                        '<li><strong>' + model.FromUserName + '</strong></li>' +
                                        '<li>' + model.Content + '</li>' +
                                        '</ul>' +
                                        '<div class="clearfix"></div>' +
                                        '</div>' +
                                        '</div>'
                                    );
                                } else {
                                    chatbox.append(
                                        '<div class="chatbox__body__message chatbox__body__message--left" id="' + model.ID + '"' + '>' +
                                        ' <div class="chatbox_timing">' +
                                        '<ul>' +
                                        '<li>' + date.getHours() + ':' + date.getMinutes() + '</li>' +
                                        '</ul>' +
                                        '</div>' +
                                        '<img src="/Content/images/' + model.FromAvatarUser + '" alt="Picture">' +
                                        '<div class="clearfix"></div>' +
                                        ' <div class="ul_section_full">' +
                                        ' <ul class="ul_msg">' +
                                        '<li><strong>' + model.FromUserName + '</strong></li>' +
                                        '<li>' + model.Content + '</li>' +
                                        '</ul>' +
                                        '<div class="clearfix"></div>' +
                                        '</div>' +
                                        '</div>'
                                    );
                                }
                            })
                        } else {
                            chatbox.append(
                                '<p>Chưa có tin nhắn...</p>'
                            );
                        }
                    }
                })
                $(".chatbox__body").animate({ scrollTop: 2000000 });
            }
            function getLastData() {
                var chatbox = $('.chatbox__body');
                var userID = $('#UserID').val();
                $.ajax({
                    url: location.origin + "/Chat/GetLastMessageClient?UserID=" + userID,
                    type: 'GET',
                    dataType: 'JSON',
                    success: function (data) {
                        var date = new Date(parseInt(data.CreatedDate.substr(6)));
                        chatbox.append(
                            '<div class="chatbox__body__message chatbox__body__message--right">' +
                            ' <div class="chatbox_timing">' +
                            '<ul>' +
                            '<li>' + date.getHours() + ':' + date.getMinutes() + '</li>' +
                            '</ul>' +
                            '</div>' +
                            '<img src="/Content/images/' + data.FromAvatarUser + '" alt="Picture">' +
                            '<div class="clearfix"></div>' +
                            ' <div class="ul_section_full">' +
                            ' <ul class="ul_msg">' +
                            '<li><strong>' + data.FromUserName + '</strong></li>' +
                            '<li>' + data.Content + '</li>' +
                            '</ul>' +
                            '<div class="clearfix"></div>' +
                            '</div>' +
                            '</div>')
                    }
                })
            }
            $('#btn-chat').click(function send() {
                var fromId = $('#UserID').val();
                var content = $('#btn-input').val();
                $.ajax({
                    url: location.origin + "/Chat/Send",
                    data: { FromUserID: fromId, ToUserID: 1, Content: content, Side: "Client" },
                    type: 'POST',
                    dataType: 'JSON',
                    success: function (data) {
                        if (data.status) {
                            $.notify("Đã gửi!", "success");
                            $("#btn-chat").show();
                            $(".loading-send").hide();
                            getLastData();
                            $('#btn-input').val("");
                            $(".chatbox__body").animate({ scrollTop: 2000000 });
                        } else {
                            $.notify("Có lỗi xảy ra!", "error");
                            return;
                        }
                    }
                })
                $("#btn-chat").hide();
                $(".loading-send").show();
            })
        });
    </script>
    <script src="~/Content/js/notify.min.js"></script>
    <script src="~/Scripts/jquery.signalR-2.4.2.min.js"></script>
    <script src="~/signalr/hubs" type="text/javascript"></script>
    <link href="~/Content/css/chatbox.css" rel="stylesheet" />
    <script src="~/Content/js/chatbox.js"></script>
</body>
</html>